angular.module("beehrm",["ionic","ionic.service.core","ngCordova","ngStorage","ngFx","ngAnimate","ionic-datepicker","beehrm.directives","beehrm.services","beehrm.factories","beehrm.controllers"]).constant("urls",{BASE_API:"http://youngminds.com.np/beehrm_mobile/"}).run(["$ionicPlatform","$cordovaDialogs","$state","$localStorage",function(e,t,n,o){e.ready(function(){var e=new Ionic.Push({onNotification:function(e){var o=e._payload.$state,a=e._payload.$stateParams;return"undefined"!=typeof o?(t.confirm(e.text,e.title,["OK","Cancel"]).then(function(e){1==e&&("undefined"!=typeof a?n.go(o,a):n.go(o))}),!0):void 0},onRegister:function(e){o.deviceToken=e},pluginConfig:{android:{iconColor:"#F8C300",badge:!0,icon:"icon"}}}),a=function(e){};e.register(a),window.plugins&&(window.plugins.nativepagetransitions.globalOptions.duration=400,window.plugins.nativepagetransitions.globalOptions.iosdelay=250,window.plugins.nativepagetransitions.globalOptions.androiddelay=250,window.plugins.nativepagetransitions.globalOptions.winphonedelay=250,window.plugins.nativepagetransitions.globalOptions.slowdownfactor=4,window.plugins.nativepagetransitions.globalOptions.fixedPixelsTop=0,window.plugins.nativepagetransitions.globalOptions.fixedPixelsBottom=0),window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.backgroundColorByHexString("#445963")})}]).config(["$stateProvider","$urlRouterProvider","$ionicConfigProvider","$httpProvider",function(e,t,n,o){e.state("app",{url:"/app","abstract":!0,templateUrl:"templates/dist/menu.html",controller:"AppCtrl"}).state("app.access",{url:"/access",views:{menuContent:{templateUrl:"templates/dist/access.html"}}}).state("app.login",{url:"/login",views:{menuContent:{templateUrl:"templates/dist/login.html",controller:"LoginCtrl"}}}).state("app.events",{url:"/events",views:{menuContent:{templateUrl:"templates/dist/events.html",controller:"EventsCtrl"}}}).state("app.notifications",{url:"/notifications",views:{menuContent:{templateUrl:"templates/dist/notifications.html",controller:"NotificationsCtrl"}}}).state("app.leaves",{url:"/leaves",views:{menuContent:{templateUrl:"templates/dist/leaves.html",controller:"LeavesCtrl"}}}).state("app.leavesBalance",{url:"/leaves-balance",views:{menuContent:{templateUrl:"templates/dist/leaves.balance.html",controller:"LeavesBalanceCtrl"}}}).state("app.leave",{url:"/leaves/:leaveId",views:{menuContent:{templateUrl:"templates/dist/leave.html",controller:"LeaveCtrl"}}}).state("app.bulletinBoard",{url:"/bulletinBoards/:bulletinId",views:{menuContent:{templateUrl:"templates/dist/bulletin.html",controller:"BulletinBoardCtrl"}}}).state("app.payslips",{url:"/payslips",views:{menuContent:{templateUrl:"templates/dist/payslips.html",controller:"PayslipsCtrl"}}}).state("app.payslip",{url:"/payslips/:slipId",views:{menuContent:{templateUrl:"templates/dist/payslip.html",controller:"PayslipCtrl"}}}).state("app.dashboard",{url:"/dashboard",views:{menuContent:{templateUrl:"templates/dist/dashboard.html",controller:"DashboardCtrl"}}}),t.otherwise("/app/access"),n.tabs.position("bottom"),n.navBar.alignTitle("center"),n.views.transition("platform"),n.scrolling.jsScrolling("false"),n.views.transition("none"),o.interceptors.push(["$q","$location","$localStorage",function(e,t,n){return{request:function(e){return e.headers=e.headers||{},n.token&&(e.headers.Authorization="Bearer "+n.token),e},responseError:function(n){return 401===n.status?t.path("/app/login"):403===n.status&&t.path("/app/access"),e.reject(n)}}}])}]),angular.module("beehrm.services",[]).service("Navigation",["$state","$ionicPlatform",function(e,t){this.goNative=function(e,n){t.ready(function(){switch(n){case"slide":window.plugins.nativepagetransitions.slide({direction:e},function(e){},function(e){});break;case"flip":window.plugins.nativepagetransitions.flip({direction:e},function(e){},function(e){});break;case"fade":window.plugins.nativepagetransitions.fade({},function(e){},function(e){});break;case"drawer":window.plugins.nativepagetransitions.drawer({origin:e,action:"open"},function(e){},function(e){});break;case"curl":window.plugins.nativepagetransitions.curl({direction:e},function(e){},function(e){});break;default:window.plugins.nativepagetransitions.slide({direction:e},function(e){},function(e){})}})}}]),angular.module("beehrm.factories",[]).factory("Auth",["$http","$localStorage","urls",function(e,t,n){return{access:function(t){return e({url:n.BASE_API,method:"POST",dataType:"json",data:t,headers:{"Content-Type":"application/json"}})},login:function(n){return e({url:t.accessData.org_app_url+"/login",method:"POST",dataType:"json",data:n,headers:{"Content-Type":"application/x.vdn.v1+json"}})},deviceToken:function(n){return e({url:t.accessData.org_app_url+"/store-device-token",method:"POST",dataType:"json",data:n,headers:{"Content-Type":"application/x.vdn.v1+json"}})},logout:function(n){return e({url:t.accessData.org_app_url+"/delete-device-token",method:"GET",dataType:"json",headers:{"Content-Type":"application/x.vdn.v1+json",Authorization:"bearer "+t.token}}),e({url:t.accessData.org_app_url+"/logout",method:"GET",dataType:"json",headers:{"Content-Type":"application/x.vdn.v1+json",Authorization:"bearer "+t.token}})}}}]).factory("Me",["$http","$localStorage","urls",function(e,t,n){return{basic:function(n){return e({url:t.accessData.org_app_url+"/me",method:"GET",dataType:"json",headers:{"Content-Type":"application/x.vdn.v1+json",Authorization:"bearer "+t.token}})},include:function(n){var o="";return angular.forEach(n,function(e,t){o+=e+","}),included=o.substring(0,o.length-1),o="undefined"==typeof included?"":included,e({url:t.accessData.org_app_url+"/me?include="+o,method:"GET",dataType:"json",headers:{"Content-Type":"application/x.vdn.v1+json",Authorization:"bearer "+t.token}})}}}]).factory("All",["$http","$localStorage","urls",function(e,t,n){return{checkInOut:function(n){var o="undefined"==typeof n[0]?"":n[0];return e({url:t.accessData.org_app_url+"/check-in-out/?"+o,method:"GET",dataType:"json",headers:{"Content-Type":"application/x.vdn.v1+json",Authorization:"bearer "+t.token}})},checkInOutRegister:function(n){return e({url:t.accessData.org_app_url+"/check-in-out/register",method:"POST",dataType:"json",data:n,headers:{"Content-Type":"application/x.vdn.v1+json",Authorization:"bearer "+t.token}})},leaveApplication:function(n){var o="undefined"==typeof n[0]?"":n[0];return e({url:t.accessData.org_app_url+"/leave-application/?"+o,method:"GET",dataType:"json",headers:{"Content-Type":"application/x.vdn.v1+json",Authorization:"bearer "+t.token}})},getLeaveTypes:function(n){return e({url:t.accessData.org_app_url+"/leave-application/get-leave-types",method:"GET",dataType:"json",headers:{"Content-Type":"application/x.vdn.v1+json",Authorization:"bearer "+t.token}})},leaveBalance:function(n){return e({url:t.accessData.org_app_url+"/leave-balance",method:"GET",dataType:"json",headers:{"Content-Type":"application/x.vdn.v1+json",Authorization:"bearer "+t.token}})},bulletinBoard:function(n){return e({url:t.accessData.org_app_url+"/bulletin-board",method:"GET",dataType:"json",headers:{"Content-Type":"application/x.vdn.v1+json",Authorization:"bearer "+t.token}})},events:function(n){return e({url:t.accessData.org_app_url+"/events",method:"GET",dataType:"json",headers:{"Content-Type":"application/x.vdn.v1+json",Authorization:"bearer "+t.token}})},submitLeaveApplication:function(n){return e({url:t.accessData.org_app_url+"/leave-application",method:"POST",dataType:"json",data:n,headers:{"Content-Type":"application/x.vdn.v1+json"}})},checkLeaveApplication:function(n){var o="undefined"==typeof n[0]?"":n[0];return e({url:t.accessData.org_app_url+"/events?"+o,method:"GET",dataType:"json",data:n,headers:{"Content-Type":"application/x.vdn.v1+json",Authorization:"bearer "+t.token}})}}}]),angular.module("beehrm.directives",[]).directive("goNative",["Navigation",function(e){return{restrict:"A",link:function(t,n,o){var a=o.direction,i=o.transitiontype;t.$on("$stateChangeStart",function(){e.goNative(a,i)})}}}]).directive("showFooter",["$rootScope","$localStorage",function(e,t){return{restrict:"A",link:function(n,o){e.showFooter||(n.$on("$ionicView.beforeEnter",function(){"undefined"!=typeof t.checkInOut&&t.checkInOut===!0?e.showFooter=!0:e.showFooter=!1}),n.$on("$stateChangeStart",function(){e.showFooter=!1}))}}}]).directive("showTabs",["$rootScope",function(e){return{restrict:"A",link:function(t,n){e.showTabs||(t.$on("$ionicView.beforeEnter",function(){e.showTabs=!0}),t.$on("$stateChangeStart",function(){e.showTabs=!1}))}}}]).directive("showLeaveFooter",["$rootScope",function(e){return{restrict:"A",link:function(t,n){e.showLeaveFooter||(t.$on("$ionicView.beforeEnter",function(){e.showLeaveFooter=!0}),t.$on("$stateChangeStart",function(){e.showLeaveFooter=!1}))}}}]).directive("showLeaveTabs",["$rootScope",function(e){return{restrict:"A",link:function(t,n){e.showLeaveTabs||(t.$on("$ionicView.beforeEnter",function(){e.showLeaveTabs=!0}),t.$on("$stateChangeStart",function(){e.showLeaveTabs=!1}))}}}]),angular.module("beehrm.controllers",[]).controller("AppCtrl",["$scope","$rootScope","$state","$timeout","$localStorage","$ionicSideMenuDelegate","$ionicLoading","$ionicHistory","$cordovaDialogs","$cordovaNetwork","Auth","All",function(e,t,n,o,a,i,r,l,s,c,d,u){r.show({template:"Loading..."}),e.$on("$ionicView.enter",function(){i.canDragContent(!1)}),e.$on("$ionicView.leave",function(){i.canDragContent(!0)}),e.isOnline=!1,document.addEventListener("deviceready",function(){e.isOnline=c.isOnline(),t.$on("$cordovaNetwork:online",function(t,n){e.isOnline=!0}),t.$on("$cordovaNetwork:offline",function(t,n){e.isOnline=!1}),"undefined"!=typeof a.userInfo?(t.userInfo=a.userInfo,t.userInfo.image="data:image/png;base64,"===a.userInfo.image?"img/profile_avatar.png":a.userInfo.image,"undefined"==typeof a.deviceTokenRegistered?d.deviceToken({deviceToken:a.deviceToken._token}).success(function(e){a.deviceTokenRegistered=!0,n.go("app.dashboard",{},{reload:!0})}).error(function(e){o(function(){r.hide(),s.alert(e.message,"Whoops","OK")},1e3)}):("undefined"==typeof a.checkInOutDate&&(a.checkInOutDate=null),a.checkInOut=!1,u.checkInOut({0:"date="+a.checkInOutDate}).success(function(t){"CHECKINOUTENABLE"===t&&(a.checkInOut=!0),"undefined"==typeof a.checkInOutEvent||"CHECKEDIN"===a.checkInOutEvent?e.checkInOutLabel="CHECK IN":e.checkInOutLabel="CHECK OUT",n.go("app.dashboard",{},{reload:!0})}).error(function(e){o(function(){r.hide(),s.alert(e.message,"Whoops","OK"),n.go("app.dashboard",{},{reload:!0})},1e3)}))):"undefined"!=typeof a.accessData?n.go("app.login",{},{reload:!0}):e.accessShow=!0,o(function(){r.hide()},1e3),e.accessData={},e.access=function(){e.isOnline?(r.show({template:"Loading..."}),d.access({org_key:e.accessData.orgKey}).success(function(t){e.accessShow=!1,a.accessData=t,r.hide(),n.go("app.login")}).error(function(e){o(function(){r.hide(),s.alert(e.message,"Whoops","OK")},1e3)})):s.alert("Please check your internet connection","Whoops","OK")},e.logout=function(){s.confirm("Wanna LogOut?","BeeHRM",["Yes","Cancel"]).then(function(t){1==t&&(r.show({template:"Loading..."}),d.logout({}).success(function(t){delete a.token,delete a.userInfo,delete a.notifications,delete a.payslip,delete a.bulletinBoard,delete a.deviceTokenRegistered,l.clearCache(),l.clearHistory(),e.loginShow=!0,n.go("app.login",{},{reload:!0}),r.hide()}).error(function(e){o(function(){r.hide(),s.alert(e.message,"Whoops","OK")},1e3)}))})},e.checkIn=function(t){"undefined"==typeof a.checkInOutEvent||"CHECKEDIN"===a.checkInOutEvent?e.condition="Check-In":e.condition="Check-Out",s.confirm("Wanna "+e.condition+"?","BeeHRM",["Yes","Cancel"]).then(function(t){1==t&&(r.show({template:"Loading..."}),e.isOnline?"Check-In"===e.condition?u.checkInOutRegister({inOutMode:0,date:a.checkInOutDate}).success(function(t){r.hide(),"CHECKINOUTDISABLE"===t?s.alert("You are already checked out for today","Whoops","OK"):(a.checkInOutEvent="CHECKEDOUT",e.checkInOutLabel="CHECK OUT",s.alert("You are now Checked In","Success","OK"))}).error(function(e){o(function(){r.hide(),s.alert(e.message,"Whoops","OK")},1e3)}):u.checkInOutRegister({inOutMode:1,date:a.checkInOutDate}).success(function(t){r.hide(),"CHECKINOUTDISABLE"===t?s.alert("You are already checked out for today","Whoops","OK"):(a.checkInOutDate=t,a.checkInOutEvent="CHECKEDIN",e.checkInOutLabel="CHECK IN",a.checkInOut=!1,s.alert("You are now Checked Out","Success","OK"))}).error(function(e){o(function(){r.hide(),s.alert(e.message,"Whoops","OK")},1e3)}):(r.hide(),s.alert("Please check your internet connection","Whoops","OK")))})}},!1)}]).controller("LoginCtrl",["$scope","$rootScope","$state","$timeout","$localStorage","$ionicLoading","$cordovaDialogs","$cordovaNetwork","Auth","Me","All",function(e,t,n,o,a,i,r,l,s,c,d){i.show({template:"Loading..."}),e.isOnline=!1,document.addEventListener("deviceready",function(){function u(){s.deviceToken({deviceToken:a.deviceToken._token}).success(function(e){a.deviceTokenRegistered=!0}).error(function(e){o(function(){i.hide(),r.alert(e.message,"Whoops","OK")},1e3)})}function p(){d.checkInOut({}).success(function(e){}).error(function(e){o(function(){i.hide(),r.alert(e.message,"Whoops","OK")},1e3)})}function f(){c.include({0:"applications",1:"payslip"}).success(function(t){a.notifications=t.data.notifications,delete t.data.notifications,a.userInfo=t.data,e.userInfo=a.userInfo,h()}).error(function(e){o(function(){i.hide(),r.alert(e.message,"Whoops","OK")},1e3)})}function h(){d.bulletinBoard({}).success(function(e){a.bulletinBoard=e.data,n.go("app.dashboard"),i.hide()}).error(function(e){o(function(){i.hide(),r.alert(e.message,"Whoops","OK")},1e3)})}e.isOnline=l.isOnline(),t.$on("$cordovaNetwork:online",function(t,n){e.isOnline=!0,"undefined"!=typeof a.token&&(i.show({template:"Please wait..."}),h())}),t.$on("$cordovaNetwork:offline",function(t,n){e.isOnline=!1}),o(function(){"undefined"!=typeof a.token?(e.userInfo=a.userInfo,e.isOnline?h():n.go("app.dashboard")):e.loginShow=!0,i.hide()},1e3),e.loginData={},e.login=function(){e.isOnline?(i.show({template:"Loading..."}),s.login({email:e.loginData.email,password:e.loginData.password}).success(function(t){e.loginShow=!1,a.token=t.token,"undefined"!=typeof a.deviceToken._token&&(u(),p()),f()}).error(function(e){o(function(){i.hide(),r.alert(e.message,"Whoops","OK")},1e3)})):r.alert("Please check your internet connection","Whoops","OK")}},!1)}]).controller("DashboardCtrl",["$scope","$rootScope","$timeout","$localStorage","$ionicLoading","$cordovaDialogs","$cordovaNetwork","All","Me",function(e,t,n,o,a,i,r,l,s){function c(){"undefined"!=typeof o.accessData&&(a.show({template:"Loading..."}),l.bulletinBoard({}).success(function(e){o.bulletinBoard=e.data,t.bulletinBoard=e.data,a.hide()}).error(function(e){n(function(){a.hide(),i.alert(e.message,"Whoops","OK")},1e3)}))}e.isOffline=!0,document.addEventListener("deviceready",function(){e.isOffline=r.isOffline(),t.$on("$cordovaNetwork:online",function(t,n){e.isOffline=!1,"undefined"!=typeof o.token&&(a.show({template:"Syncing data..."}),c())}),t.$on("$cordovaNetwork:offline",function(t,n){e.isOffline=!0}),"undefined"!=typeof o.userInfo&&(e.isOffline?t.bulletinBoard=o.bulletinBoard:("undefined"==typeof o.userInfo?s.include({0:"applications",1:"payslip"}).success(function(e){o.notifications=e.data.notifications,delete e.data.notifications,o.userInfo=e.data,t.userInfo=o.userInfo,t.userInfo.image="data:image/png;base64,"===o.userInfo.image?"img/profile_avatar.png":o.userInfo.image}).error(function(e){n(function(){a.hide(),i.alert(e.message,"Whoops","OK")},1e3)}):(t.userInfo=o.userInfo,t.userInfo.image="data:image/png;base64,"===o.userInfo.image?"img/profile_avatar.png":o.userInfo.image),c()))},!1)}]).controller("NotificationsCtrl",["$scope","$state","$localStorage","Me",function(e,t,n,o){e.notifications=n.notifications.data,e.doRefresh=function(){o.include({}).success(function(t){delete n.notifications,n.notifications=t.data.notifications,e.notifications=t.data.notifications.data,e.$broadcast("scroll.refreshComplete")}).error(function(e){$timeout(function(){$ionicLoading.hide(),$cordovaDialogs.alert(e.message,"Whoops","OK").then(function(){401==e.status_code&&(delete n.token,t.go("app.login"))})},1e3)})}}]).controller("EventsCtrl",["$scope","$timeout","$localStorage","$ionicLoading",function(e,t,n,o){t(function(){"undefined"!=typeof n.events?e.events=n.events:(o.hide(),$state.go("app.dashboard")),o.hide()},1e3)}]).controller("CheckEventCtrl",["$scope","$rootScope","$ionicModal","$timeout","$cordovaNetwork","$cordovaDialogs","$localStorage","$ionicLoading","$filter","$state","All",function(e,t,n,o,a,i,r,l,s,c,d){document.addEventListener("deviceready",function(){e.isOffline=a.isOffline(),t.$on("$cordovaNetwork:online",function(t,n){e.isOffline=!1}),t.$on("$cordovaNetwork:offline",function(t,n){e.isOffline=!0}),e.checkEventData={},n.fromTemplateUrl("templates/dist/events.check.html",{scope:e}).then(function(t){e.modal=t}),e.closeCheckEvent=function(){e.modal.hide()},e.openCheckEvent=function(){e.modal.show()},e.checkEvents=function(){e.isOffline===!1?(l.show({template:"Loading..."}),d.checkLeaveApplication({0:"from="+e.checkEventData.startDate+"&to="+e.checkEventData.endDate}).success(function(t){o(function(){l.hide(),0===t.data.length?i.alert("No events found in given dates","BeeHRM","OK").then(function(){e.checkEventData={startDate:e.checkEventData.startDate,endDate:e.checkEventData.startDate}}):(l.show({template:"Loading..."}),r.events=t.data,e.modal.hide(),c.go("app.events"))},50)}).error(function(e){o(function(){l.hide(),i.alert(e.message,"Whoops","OK")},1e3)})):(l.hide(),i.alert("Please check your internet connection","Whoops","OK").then(function(){c.go("app.dashboard")}))},e.startDatepickerObject={titleLabel:"Select Date",todayLabel:"Today",closeLabel:"Close",setLabel:"Set",setButtonType:"button-accent button-outline",todayButtonType:"button-accent button-outline",closeButtonType:"button-accent button-outline",mondayFirst:!0,templateType:"popup",modalHeaderColor:"bar-primary",modalFooterColor:"bar-primary",callback:function(e){u(e)}},e.startDate=new Date,e.checkEventData.startDate=s("date")(e.startDate,"yyyy-MM-dd","+0545");var u=function(t){"undefined"==typeof t||(e.startDate=t,e.checkEventData.startDate=s("date")(e.startDate,"yyyy-MM-dd","+0545"))};e.endDatepickerObject={titleLabel:"Select Date",todayLabel:"Today",closeLabel:"Close",setLabel:"Set",setButtonType:"button-accent button-outline",todayButtonType:"button-accent button-outline",closeButtonType:"button-accent button-outline",mondayFirst:!0,templateType:"popup",modalHeaderColor:"bar-primary",modalFooterColor:"bar-primary",callback:function(e){p(e)}},e.endDate=new Date,e.checkEventData.endDate=s("date")(e.endDate,"yyyy-MM-dd","+0545");var p=function(t){"undefined"==typeof t||(e.endDate=t,e.checkEventData.endDate=s("date")(e.endDate,"yyyy-MM-dd","+0545"))}},!1)}]).controller("LeavesCtrl",["$scope","$rootScope","$state","$localStorage","$timeout","$cordovaNetwork","$ionicLoading","$cordovaDialogs","All",function(e,t,n,o,a,i,r,l,s){function c(){s.leaveApplication({}).success(function(n){delete o.userInfo.applications,o.userInfo.applications=n,t.applications=o.userInfo.applications.data,e.total_pages=n.meta.pagination.total_pages,e.current_page=n.meta.pagination.current_page,e.leavesShow=!0,r.hide(),a(function(){e.total_pages!=e.current_page&&(e.moreDataCanBeLoaded=function(){return!0})},1e3)}).error(function(e){a(function(){r.hide(),l.alert(e.message,"Whoops","OK").then(function(){401==e.status_code&&(delete o.token,n.go("app.login"))})},1e3)}),e.loadMore=function(){var i=parseInt(e.current_page)+1;s.leaveApplication({0:"page="+i}).success(function(n){a(function(){e.total_pages=n.meta.pagination.total_pages,e.current_page=n.meta.pagination.current_page,e.total_pages==e.current_page&&(e.moreDataCanBeLoaded=function(){return!1}),t.applications=t.applications.concat(n.data),e.$broadcast("scroll.infiniteScrollComplete")},1e3)}).error(function(e){a(function(){r.hide(),l.alert(e.message,"Whoops","OK").then(function(){401==e.status_code&&(delete o.token,n.go("app.login"))})},1e3)})}}e.leavesShow=!1,r.show({template:"Loading..."}),e.moreDataCanBeLoaded=function(){return!1},e.isOffline=i.isOffline(),t.$on("$cordovaNetwork:online",function(t,n){e.isOffline=!1,r.show({template:"Syncing data..."}),c()}),t.$on("$cordovaNetwork:offline",function(t,n){e.isOffline=!0}),e.isOffline?a(function(){t.applications=o.userInfo.applications.data,e.leavesShow=!0,r.hide()},1e3):c()}]).controller("LeaveCtrl",["$scope","$rootScope","$state","$ionicLoading","$timeout","$localStorage","$stateParams","$filter","$cordovaDialogs",function(e,t,n,o,a,i,r,l,s){function c(e){var n=l("filter")(t.applications,{id:e});return n.length?n[0]:"NOTFOUND"}e.leaveShow=!1,o.show({template:"Loading..."});var d=r.leaveId,u=c(d);a(function(){o.hide(),"NOTFOUND"==u?s.alert("Something went wrong","Whoops","OK").then(function(){n.go("app.leaves")}):(e.leaveDetails=u,e.leaveDetails.approver_photo="data:image/png;base64,"===e.leaveDetails.approver_photo?"img/avatar.jpg":e.leaveDetails.approver_photo,e.leaveShow=!0)},1e3)}]).controller("LeavesBalanceCtrl",["$scope","$rootScope","$timeout","$localStorage","$ionicLoading","$cordovaDialogs","$cordovaNetwork","All","Me",function(e,t,n,o,a,i,r,l,s){function c(){"undefined"!=typeof o.accessData&&(a.show({template:"Loading..."}),l.leaveBalance({}).success(function(t){o.leaveBalance=t.data,e.leaveBalance=t.data,a.hide()}).error(function(e){n(function(){a.hide(),i.alert(e.message,"Whoops","OK")},1e3)}))}e.isOffline=!0,document.addEventListener("deviceready",function(){e.isOffline=r.isOffline(),t.$on("$cordovaNetwork:online",function(t,n){e.isOffline=!1,"undefined"!=typeof o.token&&(a.show({template:"Syncing data..."}),c())}),t.$on("$cordovaNetwork:offline",function(t,n){e.isOffline=!0}),"undefined"!=typeof o.token&&(e.isOffline?e.leaveBalance=o.leaveBalance:c())},!1)}]).controller("BulletinBoardCtrl",["$scope","$rootScope","$state","$ionicLoading","$timeout","$localStorage","$stateParams","$filter","$cordovaDialogs",function(e,t,n,o,a,i,r,l,s){function c(e){var n=l("filter")(t.bulletinBoard,{id:e});return n.length?n[0]:"NOTFOUND"}e.bulletinShow=!1,o.show({template:"Loading..."});var d=r.bulletinId,u=c(d);a(function(){o.hide(),"NOTFOUND"==u?s.alert("Something went wrong","Whoops","OK").then(function(){n.go("app.dashboard")}):(e.bulletinDetails=u,e.bulletinShow=!0)},1e3)}]).controller("ApplyLeaveCtrl",["$scope","$rootScope","$ionicHistory","$ionicModal","$timeout","$localStorage","$cordovaNetwork","$cordovaDialogs","$ionicLoading","$filter","$state","All",function(e,t,n,o,a,i,r,l,s,c,d,u){function p(t){e.halfTypeOptions=[{name:"First Half",id:"F"},{name:"Second Half",id:"S"}],e.leaveData={leaveType:t[0],halfType:e.halfTypeOptions[0],subject:"",description:""},e.leaveData.leave_days_type="F",e.leaveDaysTypeChange=function(){e.leaveData.leaveDaysType.checked===!0?(e.endDateHide=!0,e.whichHalfShow=!0,e.leaveData.leave_days_type="P"):(e.endDateHide=!1,e.whichHalfShow=!1,e.leaveData.leave_days_type="F")},o.fromTemplateUrl("templates/dist/leave.apply.html",{scope:e}).then(function(t){e.modal=t}),e.closeLeave=function(){e.modal.hide()},e.applyLeave=function(){i.disableApplyLeave===!1?e.modal.show():l.alert("You cannot apply leave right now. Please contact HR department","Whoops","OK")},e.doLeave=function(){0===e.leaveData.subject.length?l.alert("Subject field is required","Whoops","OK"):0===e.leaveData.description.length?l.alert("Description field is required","Whoops","OK"):l.confirm("Wanna submit?","BeeHRM",["Yes","Cancel"]).then(function(o){1==o&&(s.show({template:"Loading..."}),e.isOffline===!1?u.submitLeaveApplication({leave_days_type:e.leaveData.leave_days_type,subject:e.leaveData.subject,leave_type:e.leaveData.leaveType.id,leave_days_part:e.leaveData.halfType.id,startdt:e.leaveData.startDate,enddt:e.leaveData.endDate,desc:e.leaveData.description}).success(function(o){a(function(){s.hide(),l.alert(o,"Success","OK").then(function(){e.leaveData.leave_days_type="F",e.leaveData={leaveType:t[0],halfType:e.halfTypeOptions[0],subject:"",description:"",startDate:e.leaveData.startDate,endDate:e.leaveData.startDate},n.clearCache(["app.leaves"]),a(function(){s.hide(),d.go("app.leavesBalance",{},{reload:!0}),e.modal.hide()},50)})},50)}).error(function(e){a(function(){s.hide(),l.alert(e.message,"Whoops","OK")},1e3)}):(s.hide(),l.alert("Please check your internet connection","Whoops","OK")))})},e.startDatepickerObject={titleLabel:"Select Date",todayLabel:"Today",closeLabel:"Close",setLabel:"Set",setButtonType:"button-accent button-outline",todayButtonType:"button-accent button-outline",closeButtonType:"button-accent button-outline",mondayFirst:!0,templateType:"popup",modalHeaderColor:"bar-primary",modalFooterColor:"bar-primary",callback:function(e){r(e)}},e.startDate=new Date,e.leaveData.startDate=c("date")(e.startDate,"yyyy-MM-dd","+0545");var r=function(t){"undefined"==typeof t||(e.startDate=t,e.leaveData.startDate=c("date")(e.startDate,"yyyy-MM-dd","+0545"))};e.endDatepickerObject={titleLabel:"Select Date",todayLabel:"Today",closeLabel:"Close",setLabel:"Set",setButtonType:"button-accent button-outline",todayButtonType:"button-accent button-outline",closeButtonType:"button-accent button-outline",mondayFirst:!0,templateType:"popup",modalHeaderColor:"bar-primary",modalFooterColor:"bar-primary",callback:function(e){p(e)}},e.endDate=new Date,e.leaveData.endDate=c("date")(e.endDate,"yyyy-MM-dd","+0545");var p=function(t){"undefined"==typeof t||(e.endDate=t,e.leaveData.endDate=c("date")(e.endDate,"yyyy-MM-dd","+0545"))}}document.addEventListener("deviceready",function(){i.disableApplyLeave=!0,e.isOffline=r.isOffline(),t.$on("$cordovaNetwork:online",function(t,n){e.isOffline=!1}),t.$on("$cordovaNetwork:offline",function(t,n){e.isOffline=!0}),e.leaveDaysType={checked:!1},e.endDateHide=!1,e.whichHalfShow=!1,e.expandText=function(){var e=document.getElementById("txtnotes");e.style.height=e.scrollHeight+"px"},"undefined"!=typeof i.accessData&&(e.isOffline&&"undefined"!=typeof i.leaveTypeOptions?(e.leaveTypeOptions=i.leaveTypeOptions,p(e.leaveTypeOptions),i.disableApplyLeave=!1):(s.show({template:"Loading..."}),u.getLeaveTypes({}).success(function(t){i.leaveTypeOptions=t.data,e.leaveTypeOptions=t.data,"undefined"!=typeof e.leaveTypeOptions&&e.leaveTypeOptions.length>0?(p(e.leaveTypeOptions),i.disableApplyLeave=!1):p([]),s.hide()}).error(function(t){"undefined"!=typeof i.leaveTypeOptions?(e.leaveTypeOptions=i.leaveTypeOptions,p(e.leaveTypeOptions),i.disableApplyLeave=!1):a(function(){i.disableApplyLeave=!0,s.hide()},100)})))},!1)}]).controller("PayslipsCtrl",["$scope","$rootScope","$state","$ionicLoading","$timeout","$localStorage","$cordovaNetwork","$cordovaDialogs","Me",function(e,t,n,o,a,i,r,l,s){function c(){s.include({0:"payslip"}).success(function(n){i.payslip=n.data.payslip.data,t.payslip=i.payslip,e.payslipsShow=!0,o.hide()}).error(function(e){a(function(){o.hide(),l.alert(e.message,"Whoops","OK").then(function(){401==e.status_code&&(delete i.token,n.go("app.login"))})},1e3)})}e.payslipsShow=!1,o.show({template:"Loading..."}),t.$on("$cordovaNetwork:online",function(e,t){o.show({template:"Syncing data..."}),c()});var d=r.isOffline();d?a(function(){t.payslip=i.payslip,e.payslipsShow=!0,o.hide()},1e3):c()}]).controller("PayslipCtrl",["$scope","$rootScope","$state","$ionicLoading","$timeout","$localStorage","$stateParams","$filter","$cordovaDialogs",function(e,t,n,o,a,i,r,l,s){function c(e){var n=l("filter")(t.payslip,{id:e});return n.length?n[0]:"NOTFOUND"}e.payslipShow=!1,o.show({template:"Loading..."});var d=r.slipId,u=c(d);a(function(){o.hide(),"NOTFOUND"==u?s.alert("Something went wrong","Whoops","OK").then(function(){n.go("app.payslips")}):(e.payslipDetails=u,e.payslipShow=!0)},1e3)}]);